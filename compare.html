<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMC Debt Navigator - Covenant Comparison Matrix</title>
<link rel="stylesheet" href="css/theme.css">
<link rel="stylesheet" href="css/layout.css">
<style>
/* ── Content body override for wider table ── */
.content-body.wide { max-width: 1400px; }

/* ── Filter Buttons ── */
.filter-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: var(--space-lg);
  align-items: center;
}
.filter-label {
  font-size: 9px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 1.2px;
  color: var(--text-dim);
  margin-right: 4px;
}
.filter-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 14px;
  border: 1px solid var(--border);
  border-radius: 5px;
  background: var(--surface-2);
  color: var(--text-muted);
  font-family: inherit;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.15s;
  letter-spacing: 0.3px;
}
.filter-btn:hover {
  border-color: var(--text-dim);
  color: var(--text);
}
.filter-btn.active {
  background: rgba(59,130,246,0.15);
  border-color: rgba(59,130,246,0.4);
  color: var(--blue);
}
.filter-btn .count {
  font-size: 9px;
  opacity: 0.7;
}

/* ── Matrix Table ── */
.matrix-wrapper {
  overflow-x: auto;
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--surface);
}
.matrix-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
  min-width: 900px;
}
.matrix-table thead th {
  position: sticky;
  top: 0;
  z-index: 10;
  background: var(--surface-2);
  padding: 10px 12px;
  text-align: center;
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--text-muted);
  border-bottom: 2px solid var(--border);
  white-space: nowrap;
}
.matrix-table thead th:first-child {
  text-align: left;
  min-width: 180px;
  position: sticky;
  left: 0;
  z-index: 11;
}
.matrix-table tbody td {
  padding: 10px 12px;
  text-align: center;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  vertical-align: middle;
  transition: background 0.1s;
}
.matrix-table tbody td:first-child {
  text-align: left;
  font-weight: 600;
  color: var(--text);
  position: sticky;
  left: 0;
  background: var(--surface);
  z-index: 5;
  border-right: 1px solid var(--border);
}
.matrix-table tbody tr:hover td {
  background: rgba(255,255,255,0.02);
}
.matrix-table tbody tr:hover td:first-child {
  background: var(--surface-2);
}

/* ── Cell States ── */
.cell-deleted {
  color: var(--red);
  font-weight: 700;
  font-size: 10px;
  letter-spacing: 0.5px;
}
.cell-na {
  color: var(--text-dim);
  font-size: 10px;
  opacity: 0.5;
}
.cell-section {
  color: var(--blue);
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: color 0.15s;
}
.cell-section:hover {
  color: var(--cyan);
  text-decoration: underline;
}

/* ── Covenant Name Cell ── */
.cov-name {
  display: flex;
  align-items: center;
  gap: 8px;
}
.cov-name .cov-label {
  flex: 1;
}
.cov-category {
  font-size: 8px;
  letter-spacing: 0.8px;
  text-transform: uppercase;
  color: var(--text-dim);
  display: block;
  margin-top: 1px;
}
.cov-unique {
  display: inline-block;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--yellow);
  flex-shrink: 0;
  position: relative;
}
.cov-unique::after {
  content: '';
  position: absolute;
  inset: -3px;
  border-radius: 50%;
  border: 1px solid rgba(234,179,8,0.4);
}

/* ── Tooltip ── */
.matrix-table tbody td:first-child {
  position: sticky;
  left: 0;
  cursor: help;
}
.cov-tooltip {
  display: none;
  position: absolute;
  bottom: 100%;
  left: 0;
  width: 280px;
  padding: 10px 14px;
  background: var(--surface-3);
  border: 1px solid var(--border-accent);
  border-radius: 6px;
  font-size: 11px;
  font-weight: 400;
  color: var(--text-muted);
  line-height: 1.5;
  z-index: 20;
  pointer-events: none;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  white-space: normal;
  letter-spacing: 0;
  text-transform: none;
}
.cov-name-wrapper {
  position: relative;
}
.cov-name-wrapper:hover .cov-tooltip {
  display: block;
}

/* ── Legend ── */
.matrix-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-top: var(--space-lg);
  padding: 12px 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 6px;
  font-size: 11px;
  color: var(--text-muted);
}
.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}
.legend-swatch {
  width: 12px;
  height: 12px;
  border-radius: 3px;
}
.legend-swatch.deleted { background: rgba(239,68,68,0.2); border: 1px solid rgba(239,68,68,0.4); }
.legend-swatch.na { background: rgba(107,114,128,0.1); border: 1px solid rgba(107,114,128,0.3); }
.legend-swatch.present { background: rgba(59,130,246,0.15); border: 1px solid rgba(59,130,246,0.4); }
.legend-swatch.unique { background: var(--yellow); border-radius: 50%; }

/* ── Doc Header Colors ── */
.doc-col-1 { color: #fca5a5; }
.doc-col-2 { color: var(--lien-15l); }
.doc-col-3 { color: var(--lien-2l); }
.doc-col-4 { color: var(--lien-1l); }
.doc-col-5 { color: var(--lien-125l); }
.doc-col-6 { color: var(--unsec); }
.doc-col-7 { color: var(--lien-2l); }

/* ── Responsive ── */
@media (max-width: 768px) {
  .matrix-table { min-width: 700px; }
  .matrix-table thead th:first-child,
  .matrix-table tbody td:first-child {
    min-width: 140px;
  }
}
</style>
</head>
<body data-page="compare" data-base=".">

<button class="mobile-toggle">&#9776;</button>
<div class="mobile-overlay"></div>

<div class="page-wrapper">
  <aside class="sidebar" id="sidebar"></aside>

  <main class="main-content">
    <header class="content-header" id="content-header" data-breadcrumb="Covenant Comparison"></header>

    <div class="content-body wide">
      <div class="page-title-block">
        <h1>Covenant Comparison Matrix</h1>
        <div class="subtitle">Cross-document covenant analysis across all 7 AMC debt instruments</div>
      </div>

      <!-- Filter Bar -->
      <div class="filter-bar">
        <span class="filter-label">Filter by category:</span>
        <button class="filter-btn active" data-filter="all">All <span class="count" id="count-all"></span></button>
        <button class="filter-btn" data-filter="Negative">Negative <span class="count" id="count-negative"></span></button>
        <button class="filter-btn" data-filter="Affirmative">Affirmative <span class="count" id="count-affirmative"></span></button>
        <button class="filter-btn" data-filter="Protective">Protective <span class="count" id="count-protective"></span></button>
        <button class="filter-btn" data-filter="Structural">Structural <span class="count" id="count-structural"></span></button>
      </div>

      <!-- Matrix -->
      <div class="matrix-wrapper">
        <table class="matrix-table" id="covenant-matrix">
          <thead>
            <tr>
              <th>Covenant</th>
              <th class="doc-col-1">DOC 1<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">6.125% Sub</span></th>
              <th class="doc-col-2">DOC 2<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">15% PIK</span></th>
              <th class="doc-col-3">DOC 3<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">7.5% Notes</span></th>
              <th class="doc-col-4">DOC 4<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">$2B TL</span></th>
              <th class="doc-col-5">DOC 5<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">8% PIK Exch</span></th>
              <th class="doc-col-6">DOC 6<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">Odeon 12.75%</span></th>
              <th class="doc-col-7">DOC 7<br><span style="font-weight:400; font-size:8px; letter-spacing:0;">6/8% Toggle</span></th>
            </tr>
          </thead>
          <tbody id="matrix-body"></tbody>
        </table>
      </div>

      <!-- Legend -->
      <div class="matrix-legend">
        <div class="legend-item"><span class="legend-swatch present"></span> Section reference (click to view)</div>
        <div class="legend-item"><span class="legend-swatch deleted"></span> DELETED (covenant stripped)</div>
        <div class="legend-item"><span class="legend-swatch na"></span> N/A (not in document)</div>
        <div class="legend-item"><span class="legend-swatch unique"></span> Unique covenant (only in one doc)</div>
      </div>

    </div>
  </main>
</div>

<script src="js/components.js"></script>
<script>
(function() {
  'use strict';

  var base = document.body.getAttribute('data-base') || '.';

  // ── Covenant Matrix Data (inline from covenant-matrix.json) ──
  var matrixData = {
    "documents": [
      { "id": 1, "name": "DOC 1: Covenant Strip", "shortName": "DOC 1", "tranche": "AMC 6.125% Sub Notes" },
      { "id": 2, "name": "DOC 2: Muvico 15% PIK", "shortName": "DOC 2", "tranche": "Muvico Sr Sec 2029" },
      { "id": 3, "name": "DOC 3: AMC 7.5% Notes", "shortName": "DOC 3", "tranche": "AMC 7.5% Notes 2029" },
      { "id": 4, "name": "DOC 4: $2B Term Loan", "shortName": "DOC 4", "tranche": "$2B Term Loan" },
      { "id": 5, "name": "DOC 5: Muvico 8% PIK", "shortName": "DOC 5", "tranche": "Muvico Exch 2030" },
      { "id": 6, "name": "DOC 6: Odeon 12.75%", "shortName": "DOC 6", "tranche": "Odeon 12.75% 2027" },
      { "id": 7, "name": "DOC 7: 6/8% PIK Toggle", "shortName": "DOC 7", "tranche": "Muvico 6/8% PIK" }
    ],
    "covenants": [
      { "name": "Indebtedness", "category": "Negative", "description": "Limits the issuer and subsidiaries from incurring additional debt beyond specified baskets and ratio tests. Key protection against overleveraging.", "docs": { "1": "DELETED", "2": "Sec 4.05", "3": "Sec 4.05", "4": "Sec 6.01", "5": "Sec 4.05", "6": "Sec 4.06", "7": "Sec 4.05" }},
      { "name": "Restricted Payments", "category": "Negative", "description": "Restricts dividends, stock repurchases, and investments that could leak value away from creditors. Prevents cash from flowing upstream to equity.", "docs": { "1": "DELETED", "2": "Sec 4.06", "3": "Sec 4.06", "4": "Sec 6.08", "5": "Sec 4.06", "6": "Sec 4.07", "7": "Sec 4.06" }},
      { "name": "Liens", "category": "Negative", "description": "Restricts the granting of security interests on assets. Prevents the company from pledging collateral to new creditors that would prime existing ones.", "docs": { "1": "DELETED", "2": "Sec 4.07", "3": "Sec 4.07", "4": "Sec 6.02", "5": "Sec 4.07", "6": "Sec 4.08", "7": "Sec 4.07" }},
      { "name": "Affiliate Transactions", "category": "Negative", "description": "Requires transactions with related parties to be on arm's-length terms. Prevents self-dealing and value extraction through sweetheart deals.", "docs": { "1": "DELETED", "2": "Sec 4.08", "3": "Sec 4.08", "4": "Sec 6.09", "5": "Sec 4.08", "6": "Sec 4.09", "7": "Sec 4.08" }},
      { "name": "Negative Pledge", "category": "Negative", "description": "Prevents the issuer from granting liens to other creditors without equally securing these noteholders. Protects pari passu status.", "docs": { "1": "N/A", "2": "Sec 4.09", "3": "Sec 4.09", "4": "Sec 6.07", "5": "Sec 4.09", "6": "Sec 4.10", "7": "Sec 4.09" }},
      { "name": "Future Guarantors", "category": "Affirmative", "description": "Requires new subsidiaries to become guarantors and pledge their assets. Ensures the creditor pool grows as the company grows.", "docs": { "1": "DELETED", "2": "Sec 4.10", "3": "Sec 4.10", "4": "Sec 5.11", "5": "Sec 4.10", "6": "Sec 4.11", "7": "Sec 4.10" }},
      { "name": "Change of Control", "category": "Protective", "description": "Gives noteholders a put right (typically at 101%) if ownership of the company changes hands. Protects against hostile takeover impairment.", "docs": { "1": "DELETED", "2": "N/A", "3": "Sec 4.11", "4": "N/A", "5": "N/A", "6": "Sec 4.12", "7": "N/A" }},
      { "name": "Asset Sales", "category": "Negative", "description": "Requires fair value for asset dispositions and mandates use of proceeds to repay debt or reinvest. Prevents asset stripping.", "docs": { "1": "N/A", "2": "Sec 4.16", "3": "Sec 4.16", "4": "Sec 6.05", "5": "Sec 4.16", "6": "Sec 4.17", "7": "Sec 4.16" }},
      { "name": "Financial Information", "category": "Affirmative", "description": "Requires delivery of audited annual and quarterly financial statements plus compliance certificates. Ensures transparency for creditors.", "docs": { "1": "N/A", "2": "Sec 4.12", "3": "Sec 4.12", "4": "Sec 5.01", "5": "Sec 4.12", "6": "Sec 4.13", "7": "Sec 4.12" }},
      { "name": "Cash Hoarding", "category": "Negative", "description": "UNIQUE to DOC 4. Prevents AMC from accumulating excessive unrestricted cash while debt remains outstanding. Forces cash deployment toward debt reduction.", "docs": { "1": "N/A", "2": "N/A", "3": "N/A", "4": "Sec 6.13", "5": "N/A", "6": "N/A", "7": "N/A" }, "unique": true },
      { "name": "Corporate Separateness", "category": "Structural", "description": "Requires Muvico to maintain its separate legal identity from AMC parent. Prevents substantive consolidation in bankruptcy, preserving the structural seniority of Muvico-level debt.", "docs": { "1": "N/A", "2": "N/A", "3": "N/A", "4": "N/A", "5": "Sec 4.20", "6": "N/A", "7": "Sec 4.20" }},
      { "name": "Listing Maintenance", "category": "Affirmative", "description": "UNIQUE to DOC 6. Requires Odeon to maintain listing of notes on a recognized stock exchange. Standard European high-yield provision not found in US documentation.", "docs": { "1": "N/A", "2": "N/A", "3": "N/A", "4": "N/A", "5": "N/A", "6": "Sec 4.05", "7": "N/A" }, "unique": true }
    ]
  };

  // ── Doc URL map ──
  var docUrls = {
    1: 'docs/doc1-covenant-strip.html',
    2: 'docs/doc2-muvico-secured-2029.html',
    3: 'docs/doc3-amc-7500-notes.html',
    4: 'docs/doc4-credit-agreement.html',
    5: 'docs/doc5-exchangeable-2030.html',
    6: 'docs/doc6-odeon-notes.html',
    7: 'docs/doc7-pik-toggle.html'
  };

  // ── Convert section ref to anchor ──
  function sectionToAnchor(sec) {
    // "Sec 4.05" -> "#sec-4-05", "Sec 6.13" -> "#sec-6-13"
    return '#' + sec.toLowerCase().replace(/\./g, '-').replace(/\s+/g, '-');
  }

  // ── Render cell ──
  function renderCell(val, docId) {
    if (val === 'DELETED') {
      return '<span class="cell-deleted">DELETED</span>';
    }
    if (val === 'N/A') {
      return '<span class="cell-na">N/A</span>';
    }
    var url = base + '/' + docUrls[docId] + sectionToAnchor(val);
    return '<a href="' + url + '" class="cell-section">' + val + '</a>';
  }

  // ── Count categories ──
  function countCategory(cat) {
    return matrixData.covenants.filter(function(c) {
      return cat === 'all' || c.category === cat;
    }).length;
  }

  // ── Render matrix ──
  function renderMatrix(filter) {
    var tbody = document.getElementById('matrix-body');
    var html = '';

    var covenants = matrixData.covenants.filter(function(c) {
      return filter === 'all' || c.category === filter;
    });

    for (var i = 0; i < covenants.length; i++) {
      var cov = covenants[i];
      var uniqueMarker = cov.unique ? '<span class="cov-unique" title="Unique covenant"></span>' : '';
      var tooltip = cov.description ? '<div class="cov-tooltip">' + cov.description + '</div>' : '';

      html += '<tr>';
      html += '<td><div class="cov-name-wrapper"><div class="cov-name">'
        + uniqueMarker
        + '<div class="cov-label">'
        + cov.name
        + '<span class="cov-category">' + cov.category + '</span>'
        + '</div></div>'
        + tooltip
        + '</div></td>';

      for (var d = 1; d <= 7; d++) {
        html += '<td>' + renderCell(cov.docs[d], d) + '</td>';
      }
      html += '</tr>';
    }

    tbody.innerHTML = html;
  }

  // ── Initialize ──
  function init() {
    // Set counts
    document.getElementById('count-all').textContent = '(' + countCategory('all') + ')';
    document.getElementById('count-negative').textContent = '(' + countCategory('Negative') + ')';
    document.getElementById('count-affirmative').textContent = '(' + countCategory('Affirmative') + ')';
    document.getElementById('count-protective').textContent = '(' + countCategory('Protective') + ')';
    document.getElementById('count-structural').textContent = '(' + countCategory('Structural') + ')';

    // Initial render
    renderMatrix('all');

    // Filter buttons
    var buttons = document.querySelectorAll('.filter-btn');
    for (var i = 0; i < buttons.length; i++) {
      buttons[i].addEventListener('click', function() {
        for (var j = 0; j < buttons.length; j++) {
          buttons[j].classList.remove('active');
        }
        this.classList.add('active');
        renderMatrix(this.getAttribute('data-filter'));
      });
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

})();
</script>
</body>
</html>
